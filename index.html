<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TV Channel Guide</title>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    /* ── Design tokens ── */
    :root {
      --radius:     16px;
      --radius-sm:  50px;
      --transition: all 0.3s cubic-bezier(.4,0,.2,1);
      --header-h:   68px;
    }

    /* ── Light theme — lavender / soft purple ── */
    [data-theme="light"] {
      --bg:              linear-gradient(145deg,#ede9f8 0%,#f3eeff 40%,#e8f0ff 100%);
      --glow:            radial-gradient(ellipse 70% 40% at 50% -10%,rgba(124,58,237,.12) 0%,transparent 70%);
      --header-bg:       rgba(255,255,255,.78);
      --header-border:   rgba(124,58,237,.18);
      --surface:         rgba(255,255,255,.82);
      --surface-border:  rgba(124,58,237,.14);
      --text:            #1e1040;
      --text-muted:      #6b5fa0;
      --text-head:       #5b21b6;
      --input-bg:        rgba(255,255,255,.95);
      --input-border:    rgba(124,58,237,.22);
      --row-hover:       rgba(124,58,237,.06);
      --row-border:      rgba(0,0,0,.05);
      --thead-bg:        rgba(124,58,237,.07);
      --badge-bg:        rgba(124,58,237,.1);
      --badge-color:     #5b21b6;
      --badge-border:    rgba(124,58,237,.22);
      --cat-idle:        rgba(124,58,237,.08);
      --cat-idle-text:   #5b21b6;
      --cat-idle-border: rgba(124,58,237,.2);
      --cat-active-text: #fff;
      --footer-color:    #8b7cc0;
      --toggle-bg:       #ddd6fe;
      --toggle-knob:     #7c3aed;
      --shadow:          0 8px 32px rgba(124,58,237,.12);
      --header-shadow:   0 2px 20px rgba(124,58,237,.12);
      --title-color:     #1e1040;
      --select-bg:       rgba(255,255,255,.98);
      --select-color:    #1e1040;
      --modal-bg:        rgba(0,0,0,.45);
      --modal-surface:   #fff;
      --modal-text:      #1e1040;
      --modal-border:    rgba(124,58,237,.18);
      /* accent vars used throughout */
      --accent:          #7c3aed;
      --accent-mid:      #8b5cf6;
      --accent-light:    #a78bfa;
      --accent-glow:     rgba(124,58,237,.32);
      --accent-ring:     rgba(124,58,237,.18);
      /* paid variation */
      --paid-color:      #b45309;
      --paid-idle-bg:    rgba(180,83,9,.1);
      --paid-idle-border:rgba(180,83,9,.28);
      --paid-active-bg:  linear-gradient(135deg,#b45309,#d97706,#c084fc);
      --paid-glow:       rgba(180,83,9,.38);
      /* result badge */
      --result-bg:       linear-gradient(135deg,#7c3aed,#8b5cf6);
    }

    /* ── Dark theme — deep navy / purple ── */
    [data-theme="dark"] {
      --bg:              linear-gradient(145deg,#0d0720 0%,#130a2e 40%,#0a0f24 100%);
      --glow:            radial-gradient(ellipse 70% 40% at 50% -10%,rgba(124,58,237,.25) 0%,transparent 70%);
      --header-bg:       rgba(13,7,32,.85);
      --header-border:   rgba(124,58,237,.3);
      --surface:         rgba(255,255,255,.05);
      --surface-border:  rgba(255,255,255,.09);
      --text:            #ede9f8;
      --text-muted:      #9d8ec8;
      --text-head:       #c4b5fd;
      --input-bg:        rgba(255,255,255,.07);
      --input-border:    rgba(255,255,255,.14);
      --row-hover:       rgba(124,58,237,.14);
      --row-border:      rgba(255,255,255,.05);
      --thead-bg:        rgba(124,58,237,.18);
      --badge-bg:        rgba(124,58,237,.22);
      --badge-color:     #c4b5fd;
      --badge-border:    rgba(124,58,237,.38);
      --cat-idle:        rgba(255,255,255,.06);
      --cat-idle-text:   #c4b5fd;
      --cat-idle-border: rgba(255,255,255,.12);
      --cat-active-text: #fff;
      --footer-color:    #6b5fa0;
      --toggle-bg:       #2e1f5e;
      --toggle-knob:     #a78bfa;
      --shadow:          0 8px 32px rgba(0,0,0,.45);
      --header-shadow:   0 2px 24px rgba(0,0,0,.5);
      --title-color:     #ede9f8;
      --select-bg:       #130a2e;
      --select-color:    #ede9f8;
      --modal-bg:        rgba(0,0,0,.7);
      --modal-surface:   #130a2e;
      --modal-text:      #ede9f8;
      --modal-border:    rgba(124,58,237,.35);
      --accent:          #7c3aed;
      --accent-mid:      #8b5cf6;
      --accent-light:    #a78bfa;
      --accent-glow:     rgba(124,58,237,.4);
      --accent-ring:     rgba(124,58,237,.25);
      --paid-color:      #fbbf24;
      --paid-idle-bg:    rgba(251,191,36,.1);
      --paid-idle-border:rgba(251,191,36,.28);
      --paid-active-bg:  linear-gradient(135deg,#d97706,#fbbf24,#a78bfa);
      --paid-glow:       rgba(251,191,36,.35);
      --result-bg:       linear-gradient(135deg,#7c3aed,#a78bfa);
    }

    /* ── Base ── */
    body {
      font-family:'Segoe UI',system-ui,-apple-system,sans-serif;
      background: var(--bg);
      min-height: 100vh;
      color: var(--text);
      padding-top: var(--header-h);
      padding-bottom: 70px;
      transition: background .4s ease, color .3s ease;
      position: relative;
    }
    body::before {
      content:'';
      position:fixed;
      inset:0;
      background: var(--glow);
      pointer-events:none;
      z-index:0;
      transition: background .4s ease;
    }

    /* ── Sticky glassmorphism header ── */
    .site-header {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: var(--header-h);
      background: var(--header-bg);
      border-bottom: 1px solid var(--header-border);
      backdrop-filter: blur(18px) saturate(1.4);
      -webkit-backdrop-filter: blur(18px) saturate(1.4);
      box-shadow: var(--header-shadow);
      z-index: 100;
      display: flex;
      align-items: center;
      padding: 0 20px;
      transition: background .3s, box-shadow .3s, border-color .3s;
      animation: hdrFadeIn .5s ease both;
    }
    @keyframes hdrFadeIn {
      from { opacity:0; transform:translateY(-10px); }
      to   { opacity:1; transform:translateY(0); }
    }
    .header-brand {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
      min-width: 0;
    }
    .logo-img {
      height: 42px;
      width: auto;
      object-fit: contain;
      flex-shrink: 0;
      display: block;
    }
    .brand-title {
      font-size: clamp(1.05rem, 3.5vw, 1.5rem);
      font-weight: 800;
      color: var(--title-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      letter-spacing: -.3px;
      transition: color .3s;
    }

    /* ── Dark toggle ── */
    .dark-toggle {
      display: flex;
      align-items: center;
      gap: 7px;
      cursor: pointer;
      user-select: none;
      padding: 7px 14px;
      border-radius: 50px;
      background: var(--cat-idle);
      border: 1.5px solid var(--cat-idle-border);
      transition: var(--transition);
      flex-shrink: 0;
    }
    .dark-toggle:hover { box-shadow: 0 3px 14px var(--accent-glow); transform: translateY(-1px); }
    .toggle-label {
      font-size: 0.78rem;
      font-weight: 600;
      color: var(--text-muted);
      white-space: nowrap;
    }
    .toggle-switch {
      width: 36px;
      height: 19px;
      background: var(--toggle-bg);
      border-radius: 50px;
      position: relative;
      transition: background .3s;
      flex-shrink: 0;
    }
    .toggle-switch::after {
      content:'';
      position: absolute;
      width: 13px; height: 13px;
      border-radius: 50%;
      background: var(--toggle-knob);
      top: 3px; left: 3px;
      transition: transform .3s ease;
    }
    [data-theme="dark"] .toggle-switch::after { transform: translateX(17px); }

    /* ── Page container ── */
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 16px;
      position: relative;
      z-index: 1;
    }

    /* ── Page title block ── */
    .page-title-block {
      text-align: center;
      padding: 32px 16px 20px;
      animation: fadeUp .5s ease both;
    }
    .page-title-block h2 {
      font-size: clamp(1.4rem,4vw,2.2rem);
      font-weight: 800;
      color: var(--title-color);
      letter-spacing: -.4px;
    }
    .title-bar {
      width: 72px; height: 4px;
      background: linear-gradient(90deg,var(--accent),var(--accent-light));
      border-radius: 2px;
      margin: 10px auto 6px;
    }
    .page-subtitle { color: var(--text-muted); font-size: .9rem; }

    /* ── Free / Paid tab bar ── */
    .tab-bar {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-bottom: 18px;
      flex-wrap: wrap;
      animation: fadeUp .5s .08s ease both;
    }
    .tab-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 32px;
      border: 2px solid transparent;
      border-radius: 50px;
      font-size: .97rem;
      font-weight: 700;
      cursor: pointer;
      transition: var(--transition);
      letter-spacing: .3px;
    }
    .tab-btn .dot { width:8px;height:8px;border-radius:50%;background:currentColor; }

    /* Free — purple */
    .tab-btn.free {
      background: var(--cat-idle);
      color: var(--accent-mid);
      border-color: rgba(124,58,237,.25);
    }
    [data-theme="dark"] .tab-btn.free { color: var(--accent-light); }
    .tab-btn.free.active, .tab-btn.free:hover {
      background: linear-gradient(135deg,var(--accent),var(--accent-mid));
      color: #fff;
      border-color: transparent;
      box-shadow: 0 6px 22px var(--accent-glow);
      transform: translateY(-2px);
    }

    /* Paid — gold-amber */
    .tab-btn.paid {
      background: var(--paid-idle-bg);
      color: var(--paid-color);
      border-color: var(--paid-idle-border);
    }
    .tab-btn.paid.active, .tab-btn.paid:hover {
      background: var(--paid-active-bg);
      color: #fff;
      border-color: transparent;
      box-shadow: 0 6px 22px var(--paid-glow);
      transform: translateY(-2px);
    }

    /* ── Category bar ── */
    .cat-bar-wrap {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      margin-bottom: 20px;
      padding-bottom: 4px;
      animation: fadeUp .5s .14s ease both;
    }
    .cat-bar-wrap::-webkit-scrollbar { display:none; }
    .cat-bar {
      display: flex;
      gap: 8px;
      width: max-content;
      margin: 0 auto;
      padding: 0 2px;
    }
    .cat-btn {
      padding: 8px 18px;
      border-radius: 50px;
      border: 1.5px solid var(--cat-idle-border);
      background: var(--cat-idle);
      color: var(--cat-idle-text);
      font-size: .85rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      white-space: nowrap;
    }
    .cat-btn:hover { transform:translateY(-1px); box-shadow:0 4px 14px var(--accent-glow); }
    .cat-btn.active {
      background: linear-gradient(135deg,var(--accent),var(--accent-mid));
      color: var(--cat-active-text);
      border-color: transparent;
      box-shadow: 0 4px 18px var(--accent-glow);
      transform: translateY(-1px);
    }

    /* ── Filter bar ── */
    .filter-bar {
      display: flex;
      gap: 10px;
      margin-bottom: 14px;
      flex-wrap: wrap;
      align-items: center;
      animation: fadeUp .5s .2s ease both;
    }
    .search-wrap {
      flex:1;
      min-width: 200px;
      position: relative;
    }
    .search-wrap svg {
      position:absolute;
      left:14px;
      top:50%;
      transform:translateY(-50%);
      color:var(--text-muted);
      pointer-events:none;
    }
    .search-input {
      width:100%;
      padding: 11px 14px 11px 42px;
      background: var(--input-bg);
      border: 1.5px solid var(--input-border);
      border-radius: 50px;
      color: var(--text);
      font-size: .93rem;
      outline:none;
      transition: border-color .2s, box-shadow .2s;
      backdrop-filter: blur(6px);
    }
    .search-input::placeholder { color:var(--text-muted); }
    .search-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-ring);
    }
    .lang-select {
      padding: 11px 36px 11px 16px;
      background: var(--select-bg);
      border: 1.5px solid var(--input-border);
      border-radius: 50px;
      color: var(--select-color);
      font-size: .93rem;
      outline:none;
      cursor:pointer;
      transition: border-color .2s, box-shadow .2s;
      min-width: 155px;
      -webkit-appearance:none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%237c3aed' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
      background-repeat:no-repeat;
      background-position:right 14px center;
    }
    .lang-select option { background:var(--select-bg);color:var(--select-color); }
    .lang-select:focus { border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-ring); }

    /* ── Result bar ── */
    .result-bar {
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
      min-height:28px;
      flex-wrap:wrap;
      gap:8px;
      animation: fadeUp .5s .24s ease both;
    }
    .result-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 14px;
      background: var(--result-bg);
      border-radius: 50px;
      color: #fff;
      font-size: .82rem;
      font-weight: 700;
      box-shadow: 0 2px 10px var(--accent-glow);
    }
    .clear-btn {
      display:none;
      align-items:center;
      gap:6px;
      padding: 5px 14px;
      background:rgba(220,38,38,.1);
      border:1.5px solid rgba(220,38,38,.28);
      border-radius:50px;
      color:#ef4444;
      font-size:.83rem;
      font-weight:600;
      cursor:pointer;
      transition:var(--transition);
    }
    .clear-btn:hover { background:rgba(220,38,38,.2); }
    .clear-btn.show { display:flex; }

    /* ── Loading spinner ── */
    .spinner-wrap {
      display:none;
      justify-content:center;
      align-items:center;
      padding:40px;
    }
    .spinner-wrap.show { display:flex; }
    .spinner {
      width:36px;height:36px;
      border:3px solid var(--cat-idle-border);
      border-top-color: var(--accent);
      border-radius:50%;
      animation:spin .7s linear infinite;
    }
    @keyframes spin { to { transform:rotate(360deg); } }

    /* ── Table card ── */
    .table-card {
      background: var(--surface);
      border: 1px solid var(--surface-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow:hidden;
      transition: background .35s, box-shadow .35s;
      animation: fadeUp .5s .28s ease both;
    }
    .table-scroll { overflow-x:auto; }
    table { width:100%;border-collapse:collapse;font-size:.92rem; }
    thead tr { background:var(--thead-bg); }
    thead th {
      padding:13px 18px;
      text-align:left;
      font-size:.73rem;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:1px;
      color:var(--text-head);
      white-space:nowrap;
      border-bottom:1px solid var(--surface-border);
    }
    thead th:first-child { width:90px; }
    tbody tr {
      border-bottom:1px solid var(--row-border);
      transition:background .15s;
    }
    tbody tr:nth-child(even) { background:rgba(124,58,237,.025); }
    [data-theme="dark"] tbody tr:nth-child(even) { background:rgba(255,255,255,.025); }
    tbody tr:last-child { border-bottom:none; }
    tbody tr:hover { background:var(--row-hover) !important; }
    tbody td { padding:12px 18px;vertical-align:middle; }

    .ch-num-badge {
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width:46px;
      padding:3px 8px;
      background:linear-gradient(135deg,var(--accent),var(--accent-mid));
      color:#fff;
      border-radius:8px;
      font-weight:800;
      font-size:.88rem;
      font-variant-numeric:tabular-nums;
      box-shadow:0 2px 6px var(--accent-glow);
    }
    .ch-name { font-weight:500;color:var(--text); }
    .lang-tag {
      display:inline-block;
      padding:3px 10px;
      border-radius:50px;
      font-size:.72rem;
      font-weight:600;
      background:var(--badge-bg);
      color:var(--badge-color);
      border:1px solid var(--badge-border);
      white-space:nowrap;
    }

    /* ── Table fade ── */
    .table-fade { animation:fadeIn .3s ease both; }
    @keyframes fadeIn { from{opacity:0;transform:translateY(6px)} to{opacity:1;transform:translateY(0)} }
    @keyframes fadeUp  { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }

    /* ── Empty state ── */
    .empty-state {
      display:none;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding:60px 20px;
      text-align:center;
      gap:14px;
    }
    .empty-state.show { display:flex; }
    .empty-icon {
      width:62px;height:62px;border-radius:50%;
      background:var(--cat-idle);
      display:flex;align-items:center;justify-content:center;
      font-size:1.8rem;
    }
    .empty-state h3 { font-size:1.1rem;font-weight:700;color:var(--text); }
    .empty-state p  { color:var(--text-muted);font-size:.87rem; }
    .empty-clear-btn {
      padding:9px 22px;
      background:var(--cat-idle);
      border:1.5px solid var(--cat-idle-border);
      border-radius:50px;
      color:var(--cat-idle-text);
      font-size:.88rem;font-weight:600;cursor:pointer;
      transition:var(--transition);
    }
    .empty-clear-btn:hover {
      background:linear-gradient(135deg,var(--accent),var(--accent-mid));
      color:#fff;
      border-color:transparent;
    }

    /* ── Footer ── */
    footer {
      text-align:center;
      padding:28px 20px 12px;
      color:var(--footer-color);
      font-size:.82rem;
      position:relative;
      z-index:1;
    }
    .footer-logo { height:28px;width:auto;object-fit:contain;display:inline-block;margin-bottom:6px;opacity:.8; }
    .admin-link {
      margin-left:10px;
      color:var(--text-muted);
      font-size:.75rem;
      cursor:pointer;
      text-decoration:underline;
      opacity:.55;
      transition:opacity .2s;
    }
    .admin-link:hover { opacity:1; }

    /* ── MODAL base ── */
    .modal-overlay {
      display:none;
      position:fixed;inset:0;
      background:var(--modal-bg);
      z-index:200;
      align-items:center;
      justify-content:center;
      padding:16px;
      backdrop-filter:blur(6px);
      animation:overlayIn .2s ease both;
    }
    .modal-overlay.open { display:flex; }
    @keyframes overlayIn { from{opacity:0} to{opacity:1} }

    .modal {
      background:var(--modal-surface);
      border:1px solid var(--modal-border);
      border-radius:var(--radius);
      box-shadow:0 24px 60px rgba(0,0,0,.3);
      width:100%;
      max-width:500px;
      max-height:90vh;
      overflow-y:auto;
      padding:32px 28px 28px;
      position:relative;
      animation:modalIn .25s cubic-bezier(.4,0,.2,1) both;
      transition:background .3s,border-color .3s;
    }
    @keyframes modalIn { from{opacity:0;transform:translateY(24px) scale(.97)} to{opacity:1;transform:none} }

    .modal-close {
      position:absolute;top:16px;right:16px;
      width:30px;height:30px;
      border-radius:50%;
      background:var(--cat-idle);
      border:1px solid var(--cat-idle-border);
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      transition:var(--transition);
      font-size:1rem;color:var(--text-muted);
    }
    .modal-close:hover { background:rgba(220,38,38,.15);color:#ef4444; }

    .modal h2 {
      font-size:1.25rem;font-weight:800;
      color:var(--modal-text);margin-bottom:4px;
    }
    .modal .modal-sub { color:var(--text-muted);font-size:.87rem;margin-bottom:22px; }

    /* ── Admin login form ── */
    .admin-form label {
      display:block;
      font-size:.82rem;font-weight:600;
      color:var(--text-muted);margin-bottom:5px;
    }
    .admin-form input[type="password"] {
      width:100%;
      padding:11px 16px;
      background:var(--input-bg);
      border:1.5px solid var(--input-border);
      border-radius:12px;
      color:var(--modal-text);
      font-size:.95rem;
      outline:none;
      transition:border-color .2s,box-shadow .2s;
      margin-bottom:14px;
    }
    .admin-form input[type="password"]:focus {
      border-color:var(--accent);
      box-shadow:0 0 0 3px var(--accent-ring);
    }
    .admin-form-err {
      font-size:.82rem;color:#ef4444;
      margin-bottom:10px;min-height:18px;
    }
    .btn-primary {
      width:100%;
      padding:12px;
      background:linear-gradient(135deg,var(--accent),var(--accent-mid));
      color:#fff;
      border:none;border-radius:12px;
      font-size:.95rem;font-weight:700;
      cursor:pointer;
      transition:var(--transition);
      box-shadow:0 4px 16px var(--accent-glow);
    }
    .btn-primary:hover { transform:translateY(-1px);box-shadow:0 6px 20px var(--accent-glow); }

    /* ── Admin dashboard ── */
    .admin-dash { display:none; }
    .admin-dash.show { display:block; }

    .admin-section {
      background:var(--cat-idle);
      border:1px solid var(--cat-idle-border);
      border-radius:12px;
      padding:20px;
      margin-bottom:16px;
    }
    .admin-section h3 {
      font-size:.95rem;font-weight:700;color:var(--modal-text);margin-bottom:12px;
    }
    .upload-zone {
      border:2px dashed var(--cat-idle-border);
      border-radius:12px;
      padding:28px 16px;
      text-align:center;
      cursor:pointer;
      transition:var(--transition);
      position:relative;
    }
    .upload-zone:hover,
    .upload-zone.drag-over {
      border-color:var(--accent);
      background:rgba(124,58,237,.06);
    }
    .upload-zone input[type="file"] {
      position:absolute;inset:0;opacity:0;cursor:pointer;
    }
    .upload-zone p { color:var(--text-muted);font-size:.85rem;margin-top:8px; }
    .upload-zone strong { color:var(--modal-text);font-size:.95rem; }

    .upload-msg {
      margin-top:10px;font-size:.83rem;min-height:18px;font-weight:600;
    }
    .upload-msg.ok  { color:var(--accent-mid); }
    [data-theme="dark"] .upload-msg.ok { color:var(--accent-light); }
    .upload-msg.err { color:#ef4444; }

    /* preview table */
    .preview-wrap { display:none;margin-top:14px; }
    .preview-wrap.show { display:block; }
    .preview-scroll { overflow-x:auto;max-height:220px;overflow-y:auto; }
    .preview-tbl { width:100%;border-collapse:collapse;font-size:.8rem; }
    .preview-tbl th,.preview-tbl td { padding:7px 10px;border:1px solid var(--surface-border);text-align:left; }
    .preview-tbl th { background:var(--thead-bg);color:var(--text-head);font-weight:700;font-size:.72rem;text-transform:uppercase;letter-spacing:.8px; }
    .preview-tbl td { color:var(--modal-text); }
    .preview-count { font-size:.8rem;color:var(--text-muted);margin-bottom:6px; }

    .admin-btn-row { display:flex;gap:10px;flex-wrap:wrap;margin-top:6px; }
    .btn-save {
      flex:1;
      padding:10px 18px;
      background:linear-gradient(135deg,var(--accent),var(--accent-mid));
      color:#fff;border:none;border-radius:10px;
      font-size:.88rem;font-weight:700;cursor:pointer;
      transition:var(--transition);
      box-shadow:0 3px 12px var(--accent-glow);
    }
    .btn-save:hover { transform:translateY(-1px); }
    .btn-save:disabled { opacity:.45;cursor:not-allowed;transform:none; }
    .btn-reset {
      flex:1;
      padding:10px 18px;
      background:rgba(220,38,38,.1);
      color:#ef4444;
      border:1.5px solid rgba(220,38,38,.28);
      border-radius:10px;
      font-size:.88rem;font-weight:700;cursor:pointer;
      transition:var(--transition);
    }
    .btn-reset:hover { background:rgba(220,38,38,.2); }
    .btn-logout {
      width:100%;
      padding:10px;
      background:transparent;
      color:var(--text-muted);
      border:1.5px solid var(--cat-idle-border);
      border-radius:10px;
      font-size:.87rem;font-weight:600;cursor:pointer;
      transition:var(--transition);
      margin-top:4px;
    }
    .btn-logout:hover { border-color:var(--accent);color:var(--accent-mid); }
    [data-theme="dark"] .btn-logout:hover { color:var(--accent-light); }

    /* current data info */
    .data-info {
      display:flex;align-items:center;gap:8px;
      font-size:.83rem;color:var(--text-muted);
      padding:8px 12px;
      background:var(--thead-bg);
      border-radius:8px;
      margin-bottom:10px;
    }
    .data-dot {
      width:8px;height:8px;border-radius:50%;
      background:var(--accent-mid);flex-shrink:0;
    }

    /* ── Responsive ── */
    @media (max-width:600px) {
      .logo-img { height:36px; }
      .filter-bar { gap:8px; }
      .lang-select { min-width:130px;width:100%; }
      .search-wrap { min-width:100%; }
      thead th,tbody td { padding:10px 12px; }
      .tab-btn { padding:10px 22px;font-size:.88rem; }
      .dark-toggle { padding:5px 10px; }
      .toggle-label { display:none; }
      .modal { padding:24px 18px 20px; }
    }
  </style>
</head>
<body>

<!-- STICKY HEADER -->
<header class="site-header">
  <div class="header-brand">
    <img class="logo-img" src="logo.png" alt="TV Channel Guide Logo" />
    <span class="brand-title">TV Channel Guide</span>
  </div>
  <div class="dark-toggle" id="darkToggle" onclick="toggleDark()" title="Toggle dark/light mode">
    <span class="toggle-label" id="toggleLabel">&#9728; Light</span>
    <div class="toggle-switch"></div>
  </div>
</header>

<!-- MAIN CONTENT -->
<div class="container">

  <!-- Page title -->
  <div class="page-title-block">
    <h2>TV Channel Guide</h2>
    <div class="title-bar"></div>
    <p class="page-subtitle">Browse Free &amp; Paid channels &mdash; filter by category &amp; language</p>
  </div>

  <!-- Free / Paid tabs -->
  <div class="tab-bar">
    <button class="tab-btn free active" id="tabFree" onclick="switchTab('free')">
      <span class="dot"></span> Free Channels
    </button>
    <button class="tab-btn paid" id="tabPaid" onclick="switchTab('paid')">
      <span class="dot"></span> Paid Channels
    </button>
  </div>

  <!-- Category bar -->
  <div class="cat-bar-wrap">
    <div class="cat-bar" id="catBar">
      <button class="cat-btn active" data-cat="All"        onclick="switchCat('All')">All</button>
      <button class="cat-btn"        data-cat="Movies"     onclick="switchCat('Movies')">&#127909; Movies</button>
      <button class="cat-btn"        data-cat="News"       onclick="switchCat('News')">&#128240; News</button>
      <button class="cat-btn"        data-cat="Sports"     onclick="switchCat('Sports')">&#9917; Sports</button>
      <button class="cat-btn"        data-cat="Kids"       onclick="switchCat('Kids')">&#129306; Kids</button>
      <button class="cat-btn"        data-cat="Devotional" onclick="switchCat('Devotional')">&#128591; Devotional</button>
      <button class="cat-btn"        data-cat="Music"      onclick="switchCat('Music')">&#127925; Music</button>
      <button class="cat-btn"        data-cat="Regional"   onclick="switchCat('Regional')">&#127758; Regional</button>
    </div>
  </div>

  <!-- Language + Search -->
  <div class="filter-bar">
    <div class="search-wrap">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
      </svg>
      <input class="search-input" id="searchInput" type="text" placeholder="Search by name or number…" oninput="applyFilters()" />
    </div>
    <select class="lang-select" id="langSelect" onchange="applyFilters()">
      <option value="">All Languages</option>
    </select>
  </div>

  <!-- Result bar -->
  <div class="result-bar">
    <div class="result-badge" id="resultBadge">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
      <span id="resultCount">0 channels</span>
    </div>
    <button class="clear-btn" id="clearBtn" onclick="clearFilters()">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      Clear Filters
    </button>
  </div>

  <!-- Table card -->
  <div class="table-card" id="tableCard">
    <div class="spinner-wrap" id="spinnerWrap">
      <div class="spinner"></div>
    </div>
    <div class="table-scroll" id="tableScroll">
      <table id="mainTable">
        <thead>
          <tr>
            <th>No.</th>
            <th>Channel Name</th>
            <th>Language</th>
          </tr>
        </thead>
        <tbody id="mainTbody"></tbody>
      </table>
    </div>
    <div class="empty-state" id="emptyState">
      <div class="empty-icon">&#128250;</div>
      <h3>No channels found</h3>
      <p>Try a different search term, category, or language filter.</p>
      <button class="empty-clear-btn" onclick="clearFilters()">Clear Filters</button>
    </div>
  </div>

</div><!-- /container -->

<!-- FOOTER -->
<footer>
  <div>
    <img class="footer-logo" src="logo.png" alt="Logo" />
  </div>
  &copy; 2026 TV Channel Guide
  <span class="admin-link" id="adminLink" onclick="openAdmin()">Admin</span>
</footer>

<!-- ADMIN LOGIN MODAL -->
<div class="modal-overlay" id="adminLoginModal">
  <div class="modal">
    <button class="modal-close" onclick="closeAdmin()" title="Close">&#10005;</button>
    <h2>&#128274; Admin Login</h2>
    <p class="modal-sub">Enter your admin password to continue.</p>
    <div class="admin-form">
      <label for="adminPass">Password</label>
      <input type="password" id="adminPass" placeholder="Enter password…"
             onkeydown="if(event.key==='Enter')doLogin()" />
      <div class="admin-form-err" id="loginErr"></div>
      <button class="btn-primary" onclick="doLogin()">Login</button>
    </div>
  </div>
</div>

<!-- ADMIN DASHBOARD MODAL -->
<div class="modal-overlay" id="adminDashModal">
  <div class="modal" style="max-width:600px;">
    <button class="modal-close" onclick="closeDash()" title="Close">&#10005;</button>
    <h2>&#9881;&#65039; Admin Dashboard</h2>
    <p class="modal-sub">Manage channel data.</p>

    <div class="admin-dash show" id="adminDash">

      <!-- Current data info -->
      <div class="data-info" id="dataInfo">
        <div class="data-dot"></div>
        <span id="dataInfoText">Loading…</span>
      </div>

      <!-- Upload section -->
      <div class="admin-section">
        <h3>&#128196; Upload Channel Data (Excel / CSV)</h3>
        <div class="upload-zone" id="uploadZone">
          <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" onchange="handleFile(this.files[0])" />
          <div>&#128190;</div>
          <strong>Click to browse or drag &amp; drop</strong>
          <p>Accepts .xlsx, .xls, .csv &mdash; Required columns: <code>number, name, language, type</code></p>
        </div>
        <div class="upload-msg" id="uploadMsg"></div>

        <!-- Preview -->
        <div class="preview-wrap" id="previewWrap">
          <div class="preview-count" id="previewCount"></div>
          <div class="preview-scroll">
            <table class="preview-tbl" id="previewTbl">
              <thead>
                <tr><th>#</th><th>Name</th><th>Language</th><th>Type</th></tr>
              </thead>
              <tbody id="previewTbody"></tbody>
            </table>
          </div>
        </div>

        <!-- Action buttons -->
        <div class="admin-btn-row" style="margin-top:14px;">
          <button class="btn-save" id="btnSave" onclick="saveData()" disabled>
            &#128190; Save &amp; Apply
          </button>
          <button class="btn-reset" onclick="resetData()">
            &#8635; Reset to Default
          </button>
        </div>
      </div>

      <!-- Logout -->
      <button class="btn-logout" onclick="doLogout()">&#128275; Logout</button>
    </div>
  </div>
</div>

<script>
/* STATE */
let allChannels    = [];
let defaultChannels = [];
let parsedUpload   = [];
let activeTab = 'free';
let activeCat = 'All';
const LS_KEY   = 'tvGuideChannels';
const ADMIN_PW = 'admin123';

/* THEME */
function toggleDark() {
  const html = document.documentElement;
  const dark = html.getAttribute('data-theme') === 'dark';
  html.setAttribute('data-theme', dark ? 'light' : 'dark');
  document.getElementById('toggleLabel').textContent = dark ? '\u2600 Light' : '\uD83C\uDF19 Dark';
  localStorage.setItem('tvGuideTheme', dark ? 'light' : 'dark');
}
function initTheme() {
  const s = localStorage.getItem('tvGuideTheme') || 'light';
  document.documentElement.setAttribute('data-theme', s);
  document.getElementById('toggleLabel').textContent = s === 'dark' ? '\uD83C\uDF19 Dark' : '\u2600 Light';
}

/* CATEGORY CLASSIFIER */
function getCategory(ch) {
  const c = ((ch.name || '') + ' ' + (ch.language || '')).toUpperCase();
  if (/MOVIE|CINEMA|GOLD|BOLLYWOOD|PICCHAR|PICTURE|CHITRA|CINE|FILM|BHOJPURI CINEMA|ZEE CINEMA|SONY MAX|STAR GOLD|COLORS CINEPLEX/.test(c)) return 'Movies';
  if (/NEWS|KHABAR|SAMACHAR|KHABRAIN|SEITHIKAL|THALAIMURAI|SAMAY|NDTV|TIMES NOW|REPUBLIC|CNN|ABP|AAJTAK|AAJ TAK|TV9|NEWS18|WION|INDIA TODAY|INDIA TV/.test(c)) return 'News';
  if (/SPORT/.test(c)) return 'Sports';
  if (/KIDS|CARTOON|POGO|NICK|HUNGAMA|SONIC|DISNEY JUNIOR|DISCOVERY KIDS|SONY YAY|CHINTU|BAL BHARAT|JUNIOR/.test(c)) return 'Kids';
  if (/BHAKTI|DEVOTION|SANSKAR|AASTHA|AASTIK|DIVYA|ISHWAR|SHUBH|SHRADHA|SATSANG|PRARTHANA|JINVANI|SAI TV|SVBC|ARADANA|ANGEL TV|MADHA TV|NAMBIKKAI|SHALOM|GOODNESS TV|HARVEST|CALVERY|SUBHARTI|AADINATH|SARV DHARAM|PEACE OF MIND|PARAS GOLD|DHARM|GOODNEWS TV|PYRAMID MEDITATION|DIVYAVANI|AASEERVATHAM/.test(c)) return 'Devotional';
  if (/MUSIC|MTV|VH1|ZING|BALLE BALLE|TASHAN|PTC MUSIC|9X MUSIC|B4U MUSIC|MAIBOLI|SANGEET|RAJ MUSIX|DHOOM MUSIC|7S MUSIC|PUBLIC MUSIC|9X JALWA|HITS/.test(c)) return 'Music';
  return 'Regional';
}

/* TAB / CATEGORY SWITCHING */
function switchTab(tab) {
  if (activeTab === tab) return;
  activeTab = tab;
  activeCat = 'All';
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('tab' + cap(tab)).classList.add('active');
  document.querySelectorAll('.cat-btn').forEach(b => b.classList.toggle('active', b.dataset.cat === 'All'));
  document.getElementById('searchInput').value = '';
  rebuildLangOptions();
  applyFilters();
}

function switchCat(cat) {
  if (activeCat === cat) return;
  activeCat = cat;
  document.querySelectorAll('.cat-btn').forEach(b => b.classList.toggle('active', b.dataset.cat === cat));
  rebuildLangOptions();
  applyFilters();
}

/* LANGUAGE DROPDOWN */
function rebuildLangOptions() {
  const sel = document.getElementById('langSelect');
  const cur = sel.value;
  const type = cap(activeTab);
  const langs = [...new Set(
    allChannels
      .filter(c => c.type === type && (activeCat === 'All' || getCategory(c) === activeCat))
      .map(c => c.language)
  )].sort();
  while (sel.options.length > 1) sel.remove(1);
  langs.forEach(l => {
    const o = document.createElement('option');
    o.value = l; o.textContent = l;
    sel.appendChild(o);
  });
  sel.value = langs.includes(cur) ? cur : '';
}

/* FILTERING + RENDER */
function applyFilters() {
  const query = document.getElementById('searchInput').value.trim().toLowerCase();
  const lang  = document.getElementById('langSelect').value;
  const type  = cap(activeTab);
  showSpinner(true);
  setTimeout(() => {
    const filtered = allChannels.filter(c => {
      if (c.type !== type) return false;
      if (activeCat !== 'All' && getCategory(c) !== activeCat) return false;
      if (lang && c.language !== lang) return false;
      if (query && !c.name.toLowerCase().includes(query) && !String(c.number).includes(query)) return false;
      return true;
    });
    renderTable(filtered);
    updateResultBar(filtered.length, query || lang || activeCat !== 'All');
    showSpinner(false);
  }, 80);
}

function showSpinner(v) {
  document.getElementById('spinnerWrap').classList.toggle('show', v);
  document.getElementById('tableScroll').style.display = v ? 'none' : '';
  document.getElementById('emptyState').classList.remove('show');
}

function renderTable(rows) {
  const tbody = document.getElementById('mainTbody');
  const empty = document.getElementById('emptyState');
  const tbl   = document.getElementById('mainTable');
  if (rows.length === 0) {
    tbody.innerHTML = '';
    tbl.style.display = 'none';
    empty.classList.add('show');
  } else {
    tbl.style.display = '';
    empty.classList.remove('show');
    tbody.innerHTML = rows.map(c => `
      <tr>
        <td><span class="ch-num-badge">${c.number}</span></td>
        <td><span class="ch-name">${esc(c.name)}</span></td>
        <td><span class="lang-tag">${esc(c.language)}</span></td>
      </tr>
    `).join('');
    tbody.classList.remove('table-fade');
    void tbody.offsetWidth;
    tbody.classList.add('table-fade');
  }
}

function updateResultBar(count, hasFilters) {
  document.getElementById('resultCount').textContent = `${count} channel${count !== 1 ? 's' : ''}`;
  document.getElementById('clearBtn').classList.toggle('show', !!hasFilters);
}

function clearFilters() {
  document.getElementById('searchInput').value = '';
  document.getElementById('langSelect').value = '';
  activeCat = 'All';
  document.querySelectorAll('.cat-btn').forEach(b => b.classList.toggle('active', b.dataset.cat === 'All'));
  rebuildLangOptions();
  applyFilters();
}

/* HELPERS */
function cap(s) { return s.charAt(0).toUpperCase() + s.slice(1); }
function esc(s) {
  return String(s)
    .replace(/&/g,'&amp;').replace(/</g,'&lt;')
    .replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

/* BOOT / DATA LOADING */
async function loadData() {
  const res = await fetch('channels.json');
  defaultChannels = await res.json();
  const stored = localStorage.getItem(LS_KEY);
  if (stored) {
    try { allChannels = JSON.parse(stored); }
    catch(e) { allChannels = defaultChannels; }
  } else {
    allChannels = defaultChannels;
  }
  rebuildLangOptions();
  applyFilters();
}

/* ADMIN — OPEN/CLOSE */
function openAdmin() {
  if (sessionStorage.getItem('adminAuth') === '1') { openDash(); return; }
  document.getElementById('adminPass').value = '';
  document.getElementById('loginErr').textContent = '';
  document.getElementById('adminLoginModal').classList.add('open');
  setTimeout(() => document.getElementById('adminPass').focus(), 200);
}
function closeAdmin() { document.getElementById('adminLoginModal').classList.remove('open'); }
function openDash() {
  updateDataInfo();
  parsedUpload = [];
  document.getElementById('uploadMsg').textContent = '';
  document.getElementById('uploadMsg').className = 'upload-msg';
  document.getElementById('previewWrap').classList.remove('show');
  document.getElementById('btnSave').disabled = true;
  document.getElementById('fileInput').value = '';
  document.getElementById('adminDashModal').classList.add('open');
}
function closeDash() { document.getElementById('adminDashModal').classList.remove('open'); }
function updateDataInfo() {
  const stored = localStorage.getItem(LS_KEY);
  const free = allChannels.filter(c => c.type === 'Free').length;
  const paid = allChannels.filter(c => c.type === 'Paid').length;
  const src  = stored ? 'Custom (uploaded)' : 'Default (channels.json)';
  document.getElementById('dataInfoText').textContent =
    `Source: ${src} — ${allChannels.length} channels (${free} Free, ${paid} Paid)`;
}

/* ADMIN — AUTH */
function doLogin() {
  const pw = document.getElementById('adminPass').value;
  if (pw === ADMIN_PW) {
    sessionStorage.setItem('adminAuth', '1');
    closeAdmin();
    openDash();
  } else {
    document.getElementById('loginErr').textContent = 'Incorrect password. Please try again.';
    document.getElementById('adminPass').select();
  }
}
function doLogout() { sessionStorage.removeItem('adminAuth'); closeDash(); }

/* ADMIN — FILE UPLOAD */
function handleFile(file) {
  if (!file) return;
  const msg = document.getElementById('uploadMsg');
  msg.className = 'upload-msg';
  msg.textContent = 'Reading file…';
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const wb = XLSX.read(e.target.result, { type: 'array' });
      const ws = wb.Sheets[wb.SheetNames[0]];
      const raw = XLSX.utils.sheet_to_json(ws, { defval: '' });
      if (!raw.length) { showUploadErr('File is empty.'); return; }
      const rows = raw.map(r => {
        const norm = {};
        Object.keys(r).forEach(k => { norm[k.trim().toLowerCase()] = r[k]; });
        return norm;
      });
      const required = ['number','name','language','type'];
      const keys = Object.keys(rows[0]);
      const missing = required.filter(k => !keys.includes(k));
      if (missing.length) { showUploadErr(`Missing required column(s): ${missing.join(', ')}`); return; }
      const badType = rows.filter(r => !['free','paid'].includes(String(r.type).trim().toLowerCase()));
      if (badType.length) { showUploadErr(`${badType.length} row(s) have invalid "type" (must be Free or Paid).`); return; }
      parsedUpload = rows.map(r => ({
        number:   r.number,
        name:     String(r.name).trim(),
        language: String(r.language).trim(),
        type:     String(r.type).trim().charAt(0).toUpperCase() + String(r.type).trim().slice(1).toLowerCase()
      }));
      showPreview(parsedUpload);
      msg.className = 'upload-msg ok';
      msg.textContent = `✓ Parsed ${parsedUpload.length} channels successfully. Review below, then save.`;
      document.getElementById('btnSave').disabled = false;
    } catch(err) {
      showUploadErr('Failed to parse file: ' + err.message);
    }
  };
  reader.readAsArrayBuffer(file);
}
function showUploadErr(txt) {
  const msg = document.getElementById('uploadMsg');
  msg.className = 'upload-msg err';
  msg.textContent = '✗ ' + txt;
  document.getElementById('previewWrap').classList.remove('show');
  document.getElementById('btnSave').disabled = true;
  parsedUpload = [];
}
function showPreview(data) {
  const tbody = document.getElementById('previewTbody');
  const preview = data.slice(0, 50);
  tbody.innerHTML = preview.map(c => `
    <tr>
      <td>${esc(String(c.number))}</td>
      <td>${esc(c.name)}</td>
      <td>${esc(c.language)}</td>
      <td>${esc(c.type)}</td>
    </tr>
  `).join('');
  document.getElementById('previewCount').textContent =
    `Showing first ${Math.min(50, data.length)} of ${data.length} rows`;
  document.getElementById('previewWrap').classList.add('show');
}

/* ADMIN — SAVE / RESET */
function saveData() {
  if (!parsedUpload.length) return;
  allChannels = parsedUpload;
  localStorage.setItem(LS_KEY, JSON.stringify(allChannels));
  updateDataInfo();
  activeCat = 'All';
  document.querySelectorAll('.cat-btn').forEach(b => b.classList.toggle('active', b.dataset.cat === 'All'));
  document.getElementById('searchInput').value = '';
  rebuildLangOptions();
  applyFilters();
  const msg = document.getElementById('uploadMsg');
  msg.className = 'upload-msg ok';
  msg.textContent = `✓ ${allChannels.length} channels saved and applied!`;
  document.getElementById('btnSave').disabled = true;
}
function resetData() {
  if (!confirm('Reset to default channel data? This will remove any uploaded data.')) return;
  localStorage.removeItem(LS_KEY);
  allChannels = [...defaultChannels];
  parsedUpload = [];
  document.getElementById('uploadMsg').textContent = '';
  document.getElementById('uploadMsg').className = 'upload-msg';
  document.getElementById('previewWrap').classList.remove('show');
  document.getElementById('btnSave').disabled = true;
  document.getElementById('fileInput').value = '';
  updateDataInfo();
  activeCat = 'All';
  document.querySelectorAll('.cat-btn').forEach(b => b.classList.toggle('active', b.dataset.cat === 'All'));
  document.getElementById('searchInput').value = '';
  rebuildLangOptions();
  applyFilters();
}

/* DRAG & DROP */
(function() {
  const zone = document.getElementById('uploadZone');
  zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('drag-over'); });
  zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
  zone.addEventListener('drop', e => {
    e.preventDefault();
    zone.classList.remove('drag-over');
    const f = e.dataTransfer.files[0];
    if (f) handleFile(f);
  });
})();

/* CLOSE MODALS ON OVERLAY CLICK */
document.getElementById('adminLoginModal').addEventListener('click', function(e) { if (e.target === this) closeAdmin(); });
document.getElementById('adminDashModal').addEventListener('click',  function(e) { if (e.target === this) closeDash(); });

/* INIT */
initTheme();
loadData();
</script>
</body>
</html>
